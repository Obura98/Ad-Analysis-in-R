---
title: "Ad Analysis"
author: "Bill Robinson, Moringa School"
date: "`r Sys.Date()`"
output:
  html_document:
    df_print: paged
    theme: readable
    toc: yes
    toc_depth: '3'
    toc_float:
      collapsed: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---
#**Ad Analysis**

## Defining the Question
**A Kenyan entrepreneur has created an online cryptography course and would want to advertise it on her blog. She currently targets audiences originating from various countries. In the past, she ran ads to advertise a related course on the same blog and collected data in the process. She would now like to employ your services as a Data Science Consultant**

## Specifying the Question
**Help Customer Identify individuals who are likely to click on ads on client's cryptography course**

## Defining the Metric of Success
Come up with an analysis that will make our customer identify individuals who are likely to click on her cryptography course and tailor the courses to the intended individuals

## Understanding the Context
Effective advertising reaches potential customers and informs them of your products or services. ... Advertising is communication intended to inform, educate, persuade, and remind individuals of your product or businesses. Advertising must work with other marketing tools and business elements to be successful.

## Experimental Design taken
1. Data Exploration
2. Data Cleaning and Formatting
3. Univariate Analysis
4. Bivariate Analysis
5. Multivariate Analysis
6. Conclusion and Next steps

## Appropriateness data 
Our data was readily available as it was provided by the client...Thus data collection was not needed
## Loading Packages

library("dplyr")
library("purrr")
library('tidyverse')
library('magrittr')
library('corrplot')
library('caret')
library('skimr')
library(read_csv)

##Import Dataset

``` {r}
ad_df<- read.csv("dataset/advertising.csv")
## previewing first 6 rows
head(ad_df)

##previewing the last 6 rows of the dataset
tail(ad_df)
```

``` {r}
## Previewing the shape of our dataset
dim(ad_df)
### we have 1000 rows and 10 columns!!!BAM!!

#checking the datatypes on the columns 
sapply(ad_df, class)
 ## Our dataset is comprised of numeric, integer and character datatypes

##Another way to check for structure is using the str()
str(ad_df)

##the timestamp has  a wrong data type so we will need to convert it to datetime
 ad_df$Timestamp <- as.POSIXct(ad_df$Timestamp, "%Y-%m-%d %H:%M:%S",tz = "GMT")

 ### Checking if change has been effected
 sapply(ad_df, class)

## Double bam changes has been effected

##Lets now get a summary of the dataset


summary(ad_df)

```
``` {r}
##next we gonna check for unique values
unique(ad_df)

```
## Data Cleaning
``` {R}
## Converting all columns to lowercase for uniformity purposes
head(ad_df)
names(ad_df)<- tolower(names(ad_df))
head(ad_df) 
## Double Bam!!! Change has been effected

```


``` {R}
## Its now time to check and deal with missing data in our dataset
is.na(ad_df)
## To add more clarity will display missing values  in each column
colSums(is.na(ad_df))
## Tripple Bam!!!We have no missing values..This is nice

```
``` {R}
## Its now time to check and deal with duplicates data in our dataset

duplicated_rows<- ad_df[duplicated(ad_df),]
duplicated_rows
## This is awe-inspiring, we also dont have duplicated,,the data collection team should be congratulated


```
``` {R}
## Its now time to check and deal with outliers data in our dataset
## we will need to put all numerical columns in one object 

 sapply(ad_df, class)
numeric_cols <- ad_df[, c("daily.time.spent.on.site", "age","area.income","daily.internet.usage","clicked.on.ad")]

boxplot(numeric_cols)
## we have a few outliers in the area.column column but we will leave them as the values maybe useful during our analysis
```

## Univariate Analysis

``` {r}
## first we will check for the mean of all our numerical columns
```


The daily average time spent on a site was `r mean(ad_df$daily.time.spent.on.site)`
The average age of individuals was `r mean(ad_df$age)`
The  average of area.income was `r mean(ad_df$area.income)`
The daily internet usage on a site was `r mean(ad_df$daily.internet.usage)`

## checking for the median of our numerical variables


The daily median time spent on a site was `r median(ad_df$daily.time.spent.on.site)`
The median age of individuals was `r median(ad_df$age)`
The  median of area.income was `r median(ad_df$area.income)`
The daily median internet usage on a site was `r median(ad_df$daily.internet.usage)`
``` {r}
## we will find the mode using a fuction
calcmode <- function(v) {
   uniqv <- unique(v)
   uniqv[which.max(tabulate(match(v, uniqv)))]
}


daily_mode_time_spent_on_site<- calcmode(ad_df$daily.time.spent.on.site)
daily_mode_time_spent_on_site

age_mode<- calcmode(ad_df$age)
age_mode

area_income_mode<- calcmode((ad_df$area.income))
area_income_mode
internetusageonasite_mode<- calcmode(ad_df$daily.internet.usage)
internetusageonasite_mode

```

### Measures of dispersion
##min 

The daily minimum time spent on a site was `r min(ad_df$daily.time.spent.on.site)`

The minimum age of individuals was `r min(ad_df$age)`
The  minimum of area.income was `r min(ad_df$area.income)`
The daily minimum internet usage on a site was `r min(ad_df$daily.internet.usage)`

## max

The daily maximum time spent on a site was `r max(ad_df$daily.time.spent.on.site)`
The maximum age of individuals was `r max(ad_df$age)`
The  maximum of area.income was `r max(ad_df$area.income)`
The daily maximum internet usage on a site was `r max(ad_df$daily.internet.usage)`

## range

The daily range of time spent on a site was `r range(ad_df$daily.time.spent.on.site)`
The range of age of individuals was `r range(ad_df$age)`
The  range  of area.income was `r range(ad_df$area.income)`
The daily range of internet usage on a site was `r range(ad_df$daily.internet.usage)`

## QUantile ratio
The daily quantile ratio of time spent on a site was `r quantile(ad_df$daily.time.spent.on.site)`
The quantile ratio  of age of individuals was `r quantile(ad_df$age)`
The  quantile ratio   of area.income was `r quantile(ad_df$area.income)`
The daily quantile ratio  of internet usage on a site was `r quantile(ad_df$daily.internet.usage)`

## Standard Deviation

The daily  of time spent on a site was dispersed away from the mean by `r sd(ad_df$daily.time.spent.on.site)`
The of age of individuals was dispersed away from the mean by `r sd(ad_df$age)`
The  quantile ratio   of area.income was dispersed away from the mean by`r sd(ad_df$area.income)`
The daily quantile ratio  of internet usage on a site was dispersed away from the mean by `r sd(ad_df$daily.internet.usage)`

## Graphical Plots
``` {r}
##lets plot a boxplot of the daily.time.spent.on.site
boxplot(ad_df$daily.time.spent.on.site)
##from our boxplot the average daily time spent on the site was 65

```
``` {r}
##lets plot a bar graph of the frequeny distribution of our age column
age<- ad_df$age

age_frequency<-table(age)
barplot(age_frequency)

##from our bar plot, individuals at age 33 were many, mininum age was 19 nad maximum age was 61
```


```   {r}

## Bivariate and Multivariate Analysis
## Relationship btn Age and Time spent on site
library(ggplot2)
sapply(ad_df, class)
ggplot(data=ad_df,aes(y=daily.time.spent.on.site, x= age, color=clicked.on.ad))+geom_point()+facet_grid(~clicked.on.ad)
##there is no relationship between age and time spent on site

```

``` {r}
library(ggplot2)

ggplot(data=ad_df,aes(y=daily.time.spent.on.site, x= area.income,color=clicked.on.ad))+geom_point()+facet_grid(~clicked.on.ad)
sapply(ad_df, class)
##individuals who had an income of 6000 and above spent more time on the site
```
``` {r}
# computing a correlation matrix between all numerical variables using person method
correlations <- cor(numeric_cols, method = "pearson")
round(correlations, 2)
```

## Observations
1. daily time_spent_on_site has a strong negative correlations of -0.75 with click.on.add
2. age has a pretty strong correaltion of 0.49 to the click on add  but yield predictions that are too small to be useful 
3. daily internet usage has a strong negative correlation with click on add of -0.79
4. area.income has a negative correlation of -.48 to the click on ads

# corplot for correlations

``` {r}

library('corrplot')
corrplot(correlations, type = "lower", order = "hclust",tl.col = "black", tl.srt = 40)
```


``` {r}
library(ggplot2)

ggplot(data=ad_df,aes(y=age, x= area.income,color=male))+geom_point()+facet_grid(~clicked.on.ad)

##individuals aged from 20-45 had the highest income so targetting them would increase the probability of clicking an add
```


## Conclusions 
1. Client should focus on people aged 20-45 as they had the highest income
2. Client to focus on individuals who spent more time on her site as there was correlation
3. Client should also focus on people who had a higher daily internet usage as they were likely to click on her ads